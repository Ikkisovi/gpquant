# Quick Start: æ—¶åºè‡ªé€‚åº”çº¿ç­–ç•¥

## ğŸš€ 5åˆ†é’Ÿå¿«é€Ÿå¼€å§‹

### 1. éªŒè¯ç³»ç»Ÿ
```bash
python demo_ts_adaptive.py
```

è¿™å°†ï¼š
- âœ“ åŠ è½½æ•°æ®ï¼ˆä½¿ç”¨å‰5ä¸ªè‚¡ç¥¨ï¼Œæœ€è¿‘500æœŸï¼‰
- âœ“ ç”Ÿæˆ18ä¸ªæ—¶åºç‰¹å¾
- âœ“ æµ‹è¯•ç®€å•åŠ¨é‡å› å­ï¼ˆmom_rank_tsï¼‰
- âœ“ è®¡ç®—ä¿¡æ¯å¤æ™®å’Œçº¦æŸæ»¡è¶³æƒ…å†µ

**é¢„æœŸè¾“å‡º**ï¼š
```
âœ“ Registered 15 time-series operators
âœ“ Generated 18 features
Information Sharpe:     1.2345
Relative MDD â‰¤ 5%:      âœ“
Excess > 0:             âœ“
Overall:                âœ“ PASS
```

---

### 2. å®Œæ•´è®­ç»ƒï¼ˆ30-60åˆ†é’Ÿï¼‰
```bash
python train_ts_adaptive.py
```

è¿™å°†ï¼š
- Walk-forwardè®­ç»ƒï¼ˆ12æœˆè®­ç»ƒ + 1æœˆéªŒè¯ï¼‰
- æ¯ä¸ªfoldæœç´¢æœ€ä¼˜è‡ªé€‚åº”çº¿f(t)
- è¾“å‡ºç»“æœåˆ° `results_ts_adaptive.csv`

---

### 3. è‡ªå®šä¹‰é…ç½®
ç¼–è¾‘ `config_ts_adaptive.yaml`:

```yaml
# å¿«é€Ÿæµ‹è¯•ï¼ˆé™ä½è®¡ç®—é‡ï¼‰
gp_config:
  population_size: 100    # 200â†’100
  generations: 15         # 30â†’15

# æˆ–å¢å¼ºæœç´¢ï¼ˆæå‡æ€§èƒ½ï¼‰
gp_config:
  population_size: 500    # 200â†’500
  generations: 50         # 30â†’50
```

ç„¶åè¿è¡Œï¼š
```bash
python train_ts_adaptive.py --config config_ts_adaptive.yaml
```

---

## ğŸ“Š ç†è§£è¾“å‡º

### Walk-Forwardç»“æœè¡¨æ ¼
```csv
fold,formula,formula_complexity,information_sharpe,relative_mdd,meets_all_constraints,...
0,ts_ema(mom_rank_ts_20),12,1.72,0.042,True,...
1,div(ret_20,ts_std(close,30)),18,1.55,0.038,True,...
```

**å…³é”®åˆ—**ï¼š
- `formula`: GPå‘ç°çš„æœ€ä¼˜å› å­å…¬å¼
- `information_sharpe`: ç­–ç•¥vsåŸºå‡†çš„ä¿¡æ¯å¤æ™®
- `relative_mdd`: ç›¸å¯¹æœ€å¤§å›æ’¤ï¼ˆåº” â‰¤ 0.05ï¼‰
- `meets_all_constraints`: æ˜¯å¦æ»¡è¶³æ‰€æœ‰çº¦æŸ

---

## ğŸ¯ å…³é”®æ¦‚å¿µ

### ç³»ç»Ÿåšäº†ä»€ä¹ˆï¼Ÿ

1. **ç‰¹å¾å·¥ç¨‹**ï¼ˆè‡ªåŠ¨ï¼‰ï¼š
   - ç”Ÿæˆ18ä¸ªæ—¶åºç‰¹å¾ï¼ˆåŠ¨é‡ã€é£é™©ã€æµåŠ¨æ€§ç­‰ï¼‰
   - å…¨éƒ¨æŒ‰å•èµ„äº§ç‹¬ç«‹è®¡ç®—ï¼ˆæ— æˆªé¢æ³„æ¼ï¼‰

2. **GPæœç´¢**ï¼ˆæ ¸å¿ƒï¼‰ï¼š
   - æœç´¢æœ€ä¼˜"è‡ªé€‚åº”çº¿" f(t)
   - å¯ç”¨68+15=83ä¸ªç®—å­ç»„åˆ
   - ç¤ºä¾‹ï¼š`ts_ema(mom_rank_ts, 20)`, `div(ret_20, ts_std(close, 30))`

3. **ç­–ç•¥æ˜ å°„**ï¼ˆå›ºå®šï¼‰ï¼š
   ```python
   g = (price - f) / price       # åç¦»åº¦
   z = zscore(g, 40)             # æ ‡å‡†åŒ–
   w = tanh(z)                   # ä»“ä½ï¼ˆ-1åˆ°+1ï¼‰
   ```
   **é€»è¾‘**ï¼šä»·æ ¼åœ¨çº¿ä¸Šâ†’åšå¤šï¼Œçº¿ä¸‹â†’åšç©º

4. **é€‚åº”åº¦è¯„ä¼°**ï¼š
   ```python
   IS = mean(excess) / std(excess) * sqrt(504)
   - Î» * max(0, MDD_rel - 0.05)    # å›æ’¤æƒ©ç½š
   - Î³ * |excess| if excess â‰¤ 0    # æœªæ‰“è´¥åŸºå‡†
   - Î´ * complexity                 # å¤æ‚åº¦æƒ©ç½š
   - Îµ * turnover                   # æ¢æ‰‹æƒ©ç½š
   ```

5. **Walk-ForwardéªŒè¯**ï¼š
   ```
   [--12æœˆè®­ç»ƒ--][10bar embargo][1æœˆéªŒè¯]
                                         â†“
                  [--12æœˆè®­ç»ƒ--][10bar embargo][1æœˆéªŒè¯]
   ```

---

## ğŸ”§ å¸¸ç”¨è°ƒæ•´

### é—®é¢˜ï¼šè®­ç»ƒå¤ªæ…¢
**è§£å†³**ï¼šå‡å°populationå’Œgenerations
```yaml
gp_config:
  population_size: 100
  generations: 15
```

### é—®é¢˜ï¼šæ‰€æœ‰foldéƒ½å¤±è´¥ï¼ˆmeets_all_constraints = Falseï¼‰
**è§£å†³1**ï¼šæ”¾å®½çº¦æŸ
```yaml
cap_mdd: 0.08           # 0.05â†’0.08
hard_constraints: false # ä½¿ç”¨è½¯æƒ©ç½š
```

**è§£å†³2**ï¼šå¢åŠ æœç´¢ç©ºé—´
```yaml
gp_config:
  population_size: 500
  generations: 50
```

### é—®é¢˜ï¼šç­–ç•¥å‡ ä¹ä¸äº¤æ˜“
**è§£å†³**ï¼šå¢å¼ºä¿¡å·å¼ºåº¦
```yaml
k_tanh: 2.0    # 1.0â†’2.0
z_L: 20        # 40â†’20ï¼ˆæ›´çŸ­çª—å£ï¼‰
```

### é—®é¢˜ï¼šå…¬å¼è¿‡äºå¤æ‚
**è§£å†³**ï¼šå¢å¼ºç®€çº¦æ€§
```yaml
gp_config:
  parsimony_coefficient: 0.01   # 0.001â†’0.01
delta_complexity: 0.01          # 0.001â†’0.01
```

---

## ğŸ“ æ–‡ä»¶ç»“æ„

```
gpquant/
â”œâ”€â”€ gpquant_ext/                    # æ ¸å¿ƒæ¨¡å—ï¼ˆ~1600è¡Œï¼‰
â”‚   â”œâ”€â”€ ops_ts.py                   # 15ä¸ªæ—¶åºç®—å­
â”‚   â”œâ”€â”€ features.py                 # 18ä¸ªç‰¹å¾
â”‚   â”œâ”€â”€ strategy_ts.py              # å›ºå®šç­–ç•¥æ¨¡æ¿
â”‚   â”œâ”€â”€ fitness.py                  # ä¿¡æ¯å¤æ™®+çº¦æŸ
â”‚   â”œâ”€â”€ benchmark.py                # ç­‰æƒB&H
â”‚   â”œâ”€â”€ dataloader.py               # æ•°æ®åŠ è½½+Walk-forward
â”‚   â””â”€â”€ trainer.py                  # ä¸»è®­ç»ƒå¾ªç¯
â”‚
â”œâ”€â”€ train_ts_adaptive.py            # å…¥å£è„šæœ¬
â”œâ”€â”€ config_ts_adaptive.yaml         # é…ç½®æ–‡ä»¶
â”œâ”€â”€ demo_ts_adaptive.py             # å¿«é€Ÿæ¼”ç¤º
â”‚
â”œâ”€â”€ TS_ADAPTIVE_STRATEGY_README.md  # å®Œæ•´æ–‡æ¡£ï¼ˆ700+è¡Œï¼‰
â””â”€â”€ QUICK_START_TS.md               # æœ¬æ–‡ä»¶

æ•°æ®:
â””â”€â”€ daily_am_pm_data.csv            # ä½ çš„AM/PMæ—¥å†…æ•°æ®
```

---

## ğŸ’¡ æ ¸å¿ƒä¼˜åŠ¿

| ç»´åº¦ | è¯´æ˜ |
|-----|------|
| **æ— æ³„æ¼** | æ‰€æœ‰ç‰¹å¾æŒ‰å•èµ„äº§ç‹¬ç«‹è®¡ç®— |
| **ä¿¡æ¯å¤æ™®** | ç›¸å¯¹åŸºå‡†çš„è¶…é¢æ”¶ç›Šï¼Œè€Œéç»å¯¹ |
| **ä¸¥æ ¼çº¦æŸ** | å¿…é¡»æ‰“è´¥åŸºå‡†ä¸”æ§åˆ¶å›æ’¤ |
| **å¯è§£é‡Š** | ç­–ç•¥é€»è¾‘å›ºå®šï¼ŒGPåªæœç´¢çº¿ |
| **ç¨³å¥** | Walk-forward + embargoé˜²è¿‡æ‹Ÿåˆ |

---

## ğŸ†š vs åŸä¸‰çº¿ç­–ç•¥

| ç»´åº¦ | åŸä¸‰çº¿ | æ—¶åºè‡ªé€‚åº”çº¿ |
|-----|--------|------------|
| é€‚åº”åº¦ | ç»å¯¹Sharpe | **ä¿¡æ¯Sharpeï¼ˆè¶…é¢ï¼‰** |
| åŸºå‡† | æ—  | **ç­‰æƒB&Hï¼ˆå¼ºåˆ¶ï¼‰** |
| çº¦æŸ | è½¯å»ºè®® | **ç¡¬/è½¯çº¦æŸï¼ˆå¼ºåˆ¶ï¼‰** |
| ç‰¹å¾ | OHLCV | **18ä¸ªæ—¶åºç‰¹å¾** |
| ç®—å­ | 68ä¸ª | **68+15=83ä¸ª** |

---

## â“ FAQ

**Q: æœ€å°‘éœ€è¦å¤šå°‘æ•°æ®ï¼Ÿ**

A: å»ºè®®è‡³å°‘18ä¸ªæœˆï¼ˆç”¨äº12æœˆè®­ç»ƒ+1æœˆéªŒè¯+embargoï¼‰

**Q: å¯ä»¥ç”¨åœ¨æ—¥çº¿æ•°æ®ä¸Šå—ï¼Ÿ**

A: å¯ä»¥ï¼åªéœ€è°ƒæ•´ `ann_K`:
```yaml
ann_K: 252  # æ—¥çº¿ï¼ˆ252ä¸ªäº¤æ˜“æ—¥/å¹´ï¼‰
```

**Q: å¦‚ä½•è§£è¯»å…¬å¼ï¼Ÿ**

A: ç¤ºä¾‹ï¼š`ts_ema(mom_rank_ts, 20)`
- `mom_rank_ts`: ç¨³å¥åŠ¨é‡åœ¨è‡ªèº«å†å²ä¸­çš„åˆ†ä½æ•°
- `ts_ema(..., 20)`: å¯¹å…¶åš20æœŸæŒ‡æ•°ç§»åŠ¨å¹³å‡
- å«ä¹‰ï¼šå¹³æ»‘çš„åŠ¨é‡å¼ºåº¦ä½œä¸ºè‡ªé€‚åº”çº¿

**Q: ä¸ºä»€ä¹ˆä¸ç›´æ¥ç”¨Sharpeè€Œç”¨ä¿¡æ¯Sharpeï¼Ÿ**

A: ä¿¡æ¯Sharpeè¡¡é‡**ç›¸å¯¹åŸºå‡†çš„è¶…é¢æ”¶ç›Š**ï¼Œç¡®ä¿ç­–ç•¥çœŸæ­£å¢åŠ ä»·å€¼è€Œä¸æ˜¯é å¸‚åœºbetaã€‚

---

## ğŸ“– ä¸‹ä¸€æ­¥

1. âœ… è¿è¡Œ `demo_ts_adaptive.py` éªŒè¯ç³»ç»Ÿ
2. ğŸ“Š è¿è¡Œ `train_ts_adaptive.py` å®Œæ•´è®­ç»ƒ
3. ğŸ“ˆ åˆ†æ `results_ts_adaptive.csv` ç»“æœ
4. ğŸ”§ è°ƒæ•´ `config_ts_adaptive.yaml` ä¼˜åŒ–
5. ğŸ“š é˜…è¯» `TS_ADAPTIVE_STRATEGY_README.md` æ·±å…¥ç†è§£

---

## ğŸ“ å­¦ä¹ è·¯å¾„

### Level 1: å¿«é€Ÿä½¿ç”¨
- [ ] è¿è¡Œdemoè„šæœ¬
- [ ] è¿è¡Œå®Œæ•´è®­ç»ƒ
- [ ] æŸ¥çœ‹ç»“æœCSV

### Level 2: ç†è§£åŸç†
- [ ] é˜…è¯»å®Œæ•´README
- [ ] æŸ¥çœ‹features.pyä¸­çš„18ä¸ªç‰¹å¾
- [ ] ç†è§£strategy_ts.pyçš„å›ºå®šæ˜ å°„

### Level 3: æ·±åº¦å®šåˆ¶
- [ ] åœ¨ops_ts.pyä¸­æ·»åŠ è‡ªå®šä¹‰ç®—å­
- [ ] åœ¨features.pyä¸­æ·»åŠ æ–°ç‰¹å¾
- [ ] è°ƒæ•´fitness.pyçš„çº¦æŸæƒé‡
- [ ] ä¿®æ”¹strategy_ts.pyçš„æ˜ å°„å‡½æ•°

---

## âœ… æ£€æŸ¥æ¸…å•

å¼€å§‹è®­ç»ƒå‰ç¡®è®¤ï¼š

- [ ] `daily_am_pm_data.csv` åœ¨å½“å‰ç›®å½•
- [ ] æ•°æ®åŒ…å«å¿…éœ€å­—æ®µï¼ˆsymbol, timestamp, ohlcv, vwap, turnover, mktcapï¼‰
- [ ] è‡³å°‘æœ‰18ä¸ªæœˆçš„æ•°æ®
- [ ] Pythonç¯å¢ƒå·²å®‰è£…pandas, numpy, pyyaml, numba
- [ ] gpquantå·²æ­£ç¡®å®‰è£…

è¿è¡Œæ£€æŸ¥ï¼š
```bash
python -c "from gpquant_ext.ops_ts import register_ts_ops; register_ts_ops()"
```

åº”è¾“å‡ºï¼š
```
âœ“ Registered 15 time-series operators to GPQuant
```

---

## ğŸš€ å¼€å§‹è®­ç»ƒï¼

```bash
# 1. éªŒè¯ç³»ç»Ÿ
python demo_ts_adaptive.py

# 2. å®Œæ•´è®­ç»ƒ
python train_ts_adaptive.py

# 3. æŸ¥çœ‹ç»“æœ
cat results_ts_adaptive.csv
```

**ç¥ä½ å‘ç°ä¼˜ç§€çš„è‡ªé€‚åº”çº¿ç­–ç•¥ï¼** ğŸ¯
